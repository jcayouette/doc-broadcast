<!doctype html>
<html lang="en">

<!-- head -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Live Patching with SUSE Manager</title>
    <meta name="description" content="This site generates SUSE documentation using jekyll, asciidoc, travis and github.">
    <meta name="author" content="Your name goes here">
    <meta name="copyright" content="Maybe consider a Creative Commons license">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <script src="https://use.fontawesome.com/abbdb82656.js"></script>

    <link rel="stylesheet" href="assets/css/custom.css">
    <link rel="stylesheet" href="assets/css/coderay.css">
    <link rel="stylesheet" href="assets/css/asciidoctor.css">

    <div class="content"><nav class="navbar navbar-toggleable-md navbar-light" style="background-color: #EDEDED;">
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="#">SUSE Live Documentation (ALPHA)</a>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="https://jcayouette.github.io/suse-publisher/index.html">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Link</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled" href="#">Disabled</a>
            </li>
        </ul>
        <div id="navigation">
<input type="text" id="search-box" />
</div>
          <!--
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search" id="search-box">

            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button> -->
        </form>
    </div>
</nav>
</div>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Arvo|Bitter|Copse|Cutive|Lora:700|Sanchez|Scope+One|Slabo+27px|Trocchi|Vesper+Libre" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Barlow" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">


</head>


<body class="landing-page">
<!-- Top most navbar -->


<!-- Page Content -->
<div class="container">
    <div class="post-header">
    <h1 class="post-title-main">Live Patching with SUSE Manager</h1>
</div>
<div id="search-box">
  <!-- SearchBox widget will appear here -->
</div>

<div id="hits">
  <!-- Hits widget will appear here -->
</div>

<script>
  const search = instantsearch(options);

  // initialize SearchBox
  search.addWidget(
    instantsearch.widgets.searchBox({
      container: '#search-box',
      placeholder: 'Search for products'
    })
  );

  // initialize hits widget
  search.addWidget(
    instantsearch.widgets.hits({
      container: '#hits'
    })
  );

  search.start();
</script>

<!-- If this does not work place post-content back in div and remove article -->
<div class="post-content">
    <!-- HACK enough for the demo lol -->
    

    
      <a target="_blank" href="https://github.com/jcayouette/example-manager-docs/edit/master/docs/manager-docs/manager32/bp_live_patching.adoc" class="btn btn-primary" role="button"> Edit me</a>
    

    <!-- page content -->
    <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_live.patching.intro">1. Introduction</a></li>
<li><a href="#_live.patching.req">2. Initial Setup Requirements</a></li>
<li><a href="#_live.patching.setup">3. Live Patching Setup</a></li>
<li><a href="#_live.patching.clones">4. Cloning Channels</a></li>
<li><a href="#_live.patching.kernel">5. Removing Non-live Kernel Patches from the Cloned Channels</a></li>
<li><a href="#_live.patching.channel_promo">6. Promoting Channels</a></li>
<li><a href="#_live.patching.applying">7. Applying Live Patches to a Kernel</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_live.patching.intro">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Under normal circumstances a system needs to be rebooted after a kernel update.
SLE Live Patching allows you skipping the reboot by applying a subset of Linux kernel releases injected via kGraft live patching technology.</p>
</div>
<div class="paragraph">
<p>In the following sections you will learn how to use SLE Live Patching to avoid the typical reboot requirement after updating a system kernel.</p>
</div>
<div class="paragraph">
<p>For in depth information covering kGraft use, see <a href="https://www.suse.com/documentation/sles-12/singlehtml/book_sle_admin/book_sle_admin.html#cha.kgraft" class="bare">https://www.suse.com/documentation/sles-12/singlehtml/book_sle_admin/book_sle_admin.html#cha.kgraft</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_live.patching.req">2. Initial Setup Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To work with SLE Live Patching the following expectations are assumed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{susemgr} fully updated.</p>
</li>
<li>
<p>At least 1 Salt Minion running SLES 12 SP1 or later and registered with {susemgr} .</p>
</li>
<li>
<p>The matching SLES 12 SPx channels including the SLE Live Patching child channel fully synced.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_live.patching.setup">3. Live Patching Setup</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Subscribe all systems to be managed via live patching to your fully synced live patching child channels within your systems base channel by browsing to <span class="menuseq"><b class="menu">Software</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Software Channels</b></span> . Select both live patching channels and change subscription.</p>
<div class="paragraph">
<p>NOTE:
When subscribing to a channel that contains a product, the product package will automatically be installed on traditionaly registered systems and added to the package state on Salt managed systems.
For Salt managed systems please apply the highstate to push these changes to your systems.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="enable_live_patching_channels.png" alt="enable live patching channels">
</div>
</div>
</li>
<li>
<p>Use the search field listed under <span class="menuseq"><b class="menu">Software</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Packages</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Install</b></span> to install the latest <code class="path">kgraft</code> package to all systems to be managed via live patching.</p>
<div class="imageblock">
<div class="content">
<img src="enable_live_patching_kgraft_install.png" alt="enable live patching kgraft install">
</div>
</div>
</li>
<li>
<p>Apply the highstate to enable live patching:</p>
<div class="imageblock">
<div class="content">
<img src="enable_live_patching_apply_highstate.png" alt="enable live patching apply highstate">
</div>
</div>
</li>
<li>
<p>Once the highstate has been applied on Salt systems or the package has been installed on traditional systems browse to the systems details page for confirmation that live patching has been enabled. You can check the live patching state listed under the <span class="menuseq"><b class="menu">System Info</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Kernel</b></span> table field:</p>
<div class="imageblock">
<div class="content">
<img src="enable_live_patching_successful.png" alt="enable live patching successful">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_live.patching.clones">4. Cloning Channels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is considered best practice to clone a vendor channel that will be modified into a new channel with one of the following prefix names: <code>dev</code>, <code>testing</code>, and <code>prod</code>.
In the following procedure you will clone the default vendor channel into a new channel named <code class="systemitem">dev-sles12-sp3-pool-x86_64</code>
 using the command line.</p>
</div>
<div id="_proc.live.patching.clones" class="olist arabic">
<ol class="arabic">
<li>
<p>Open a terminal and as root enter:</p>
<div class="listingblock">
<div class="content">
<pre># spacewalk-manage-channel-lifecycle -list-channels
Spacewalk Username: admin
Spacewalk Password:
Channel tree:

 1. sles{sles-version}
-sp{sp-ver}
-pool-x86_64
      \__ sle-live-patching{sles-version}
-pool-x86_64-sp{sp-ver}
\__ sle-live-patching{sles-version}
-updates-x86_64-sp{sp-ver}
\__ sle-manager-tools{sles-version}
-pool-x86_64-sp{sp-ver}
\__ sle-manager-tools{sles-version}
-updates-x86_64-sp{sp-ver}
\__ sles{sles-version}
-sp{sp-ver}
-updates-x86_64</pre>
</div>
</div>
</li>
<li>
<p>Now use the <em>-init</em> argument to automatically create a new development clone of the original vendor channel:</p>
<div class="listingblock">
<div class="content">
<pre>spacewalk-manage-channel-lifecycle -init -c sles{sles-version}
-sp{sp-ver}
-pool-x86_64</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_live.patching.kernel">5. Removing Non-live Kernel Patches from the Cloned Channels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the following procedure you will remove all kernel patch updates located in the dev-sles{sles-version}
-sp{sp-ver}
-updates-x86_64 channel that require a reboot.
You created dev-sles{sles-version}
-sp{sp-ver}
-updates-x86_64 during <a href="#_proc.live.patching.clones">[_proc.live.patching.clones]</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the current kernel version in use on your client:</p>
<div class="listingblock">
<div class="content">
<pre># uname -r
3.12.62-60.64.8-default</pre>
</div>
</div>
</li>
<li>
<p>From the {susemgr}{webui} select <span class="menuseq"><b class="menu">Software</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Manage Software Channels</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Overview</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">dev-sles12-sp3-updates-x86_64</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">Patches</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">List/Remove</b></span> . Type <code>kernel</code> in the search field. Find the kernel version that matches the kernel in use on your minion.</p>
</li>
<li>
<p>Remove all kernel update versions that are later than the current kernel.</p>
</li>
<li>
<p>Your channel is now ready to promote for testing SLE Live Patching.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_live.patching.channel_promo">6. Promoting Channels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following procedure will guide you through promoting and cloning a development channel to a testing channel.
You will change the subscription from the dev repositories on your client to the new testing channel repositories.
You will also add the SLE Live Patching child channels to your client.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Promote and clone the <code>dev-sles{sles-version} -sp{sp-ver} -pool-x86_64</code> to a new testing channel:</p>
<div class="listingblock">
<div class="content">
<pre>{prompt.root}
spacewalk-manage-channel-lifecycle -promote -c dev-sles{sles-version}
-sp{sp-ver}
-pool-x86_64</pre>
</div>
</div>
</li>
<li>
<p>From the {susemgr}{webui} under the <span class="menuseq"><b class="menu">Systems</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">] tab select your client system to view the menu:System Details[</b></span> page. Select <span class="menuseq"><b class="menu">Software</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Software Channels</b></span> . From the Software Channels page you can edit which channels a system is subscribed to. Select the new base software channel, in this case it should be <code class="systemitem">test-sles12-sp3-pool-x86_64</code> . Click the <span class="menuseq"><b class="menu">Confirm</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">] button to switch the Base Software Channel and finalize it by clicking the menu:Modify Base Software Channel[</b></span> button.</p>
</li>
<li>
<p>From the <span class="menuseq"><b class="menu">Software Channels</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">] page select and add both SLE Live Patching child channels by clicking the menu:Change Subscriptions[</b></span> button.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_live.patching.applying">7. Applying Live Patches to a Kernel</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following procedure will guide you through selecting and viewing available CVE Patches (Common Vulnerabilities and Exposures) then applying these kernel updates using the new SLE Live Patching feature.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select your SLES {sles-version} SP{sp-ver} minion from the <span class="menuseq"><b class="menu">Systems</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">] page to view its menu:System Details[</b></span> . Once you have added the SLES {sles-version} SP{sp-ver} Updates child channel to your client, you should see several <code>Critical</code> software updates available. Click on <code>Critical</code> to see a list of available patches. Select any of these patches listed with the following synopsis: <em>Important: Security update for the Linux kernel</em>. All fixed security bugs will be listed along with their number. For example:(CVE-2016-8666)</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Reboot Icon</div>
Normal or non-live kernel patches always require a reboot.
In {susemgr}
these are represented by a <code>Reboot Required</code> icon located next to the <code>Security</code> shield icon.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>You can search for individual CVE&#8217;s by selecting the <b class="menuref">Audit</b> tab from the navigation menu. Try searching for <code>CVE-2016-8666</code>. You will see that the patch is available in the vendor update channel and the systems it applies to will be listed.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">CVE Availability</div>
<div class="paragraph">
<p>Not all security issues can be fixed by applying a live patch.
Some security issues can only be fixed by applying a full kernel update and will required a reboot.
The assigned CVE numbers for these issues are not included in live patches.
A CVE audit will display this requirement.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>


</div>
<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'WNURXD2O78',
  indexName: 'suse-publisher',
  apiKey: '761b121f117dc5882bfa9e6b1a7abd88'
});

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-box',
    placeholder: 'Search in documents...',
    poweredBy: true // This is required if you're on the free Community plan
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '#search-hits'
  })
);

// Starting the search
search.start();
</script>


</div>


<!-- Footer -->

<footer class="row">

</footer>

<!-- <script src="js/vendor/jquery.js"></script>
<script src="js/foundation.min.js"></script>
<script>
    $(document).foundation();
    var doc = document.documentElement;
    doc.setAttribute('data-useragent', navigator.userAgent);
</script>-->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'WNURXD2O78',
  indexName: 'suse-publisher',
  apiKey: '761b121f117dc5882bfa9e6b1a7abd88'
});

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-box',
    placeholder: 'Search in documents...',
    poweredBy: true // This is required if you're on the free Community plan
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '#search-hits'
  })
);

// Starting the search
search.start();
</script>

</body>
</html>
